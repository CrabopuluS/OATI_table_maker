# Настольный MVP конструктора таблиц ОАТИ

Приложение в каталоге `MVP` позволяет офлайн сформировать итоговую таблицу по тем же правилам,
что и веб-версия из корня репозитория.

## Запуск

```bash
python -m MVP.main
```

Перед запуском убедитесь, что установлен пакет `openpyxl` (используется для чтения и записи Excel).

При необходимости можно запустить файл напрямую:

```bash
python MVP/main.py
```

## Возможности

- Загрузка выгрузки нарушений и перечня объектов без сети.
- Автосопоставление колонок с возможностью ручной корректировки.
- Выбор отчётного и предыдущего периодов на основании дат из выгрузки.
- Фильтрация по типам объектов, видам нарушений и источнику данных.
- Просмотр итоговой таблицы прямо в окне и выгрузка в Excel.

## Тесты

```bash
pytest MVP/tests/test_report_builder.py
```

## Сборка исполняемого файла

Для формирования автономного `.exe`-файла под Windows рекомендуется использовать [PyInstaller](https://pyinstaller.org). Выполните команды в корне проекта в среде Windows с установленными зависимостями:

```bash
pip install -r requirements.txt  # при необходимости создайте виртуальное окружение
pip install pyinstaller
pyinstaller --noconsole --onefile --name OATI_Table_MVP MVP/main.py
```

Готовый исполняемый файл появится в каталоге `dist/OATI_Table_MVP.exe`. Если требуется включить дополнительные файлы (например, шаблоны), их можно добавить через ключ `--add-data` PyInstaller.
